<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIæ´»ç”¨è¨ºæ–­ãƒ¬ãƒãƒ¼ãƒˆ - ä¼æ¥­ã®AIæ´»ç”¨çŠ¶æ³ã‚’å¯è¦–åŒ–</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap');
        body { 
            font-family: 'Noto Sans JP', sans-serif; 
            margin: 0;
            padding: 0;
        }
        .accent-color { color: #5cb85c; }
        .accent-bg { background-color: #5cb85c; }
        .accent-border { border-color: #5cb85c; }
        
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #5cb85c;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        canvas {
            max-width: 100%;
            height: auto !important;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root">
        <div style="display: flex; justify-content: center; align-items: center; height: 100vh; flex-direction: column;">
            <div class="loading-spinner"></div>
            <p style="margin-top: 20px; color: #666;">èª­ã¿è¾¼ã¿ä¸­...</p>
        </div>
    </div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ï¼ˆCORSå•é¡Œã®å›é¿ç”¨ï¼‰
        const SAMPLE_DATA = [
            { 'ç¤¾å“¡ID': 'id_001', 'éƒ¨ç½²': 'å–¶æ¥­éƒ¨', 'Q1.åˆ©ç”¨é »åº¦': 'æ¯æ—¥åˆ©ç”¨', 'Q2.ãƒã‚¤ãƒ³ãƒ‰': 'å¤§ããªãƒãƒ£ãƒ³ã‚¹', 'Q3.æŒ‡ç¤ºè‡ªä¿¡': 'è‡ªä¿¡ãŒã‚ã‚‹', 'Q4.è¦‹æŠœãè‡ªä¿¡': 'è¦‹æŠœã‘ã‚‹', 'Q5.æ©Ÿå¯†æƒ…å ±å…¥åŠ›': 'ã„ã„ãˆ', 'Q6.è‘—ä½œæ¨©ç†è§£': 'ç†è§£ã—ã¦ã„ã‚‹', 'Xè»¸ã‚¹ã‚³ã‚¢ (æ„æ¬²)': '5', 'Yè»¸ã‚¹ã‚³ã‚¢ (ã‚¹ã‚­ãƒ«)': '5' },
            { 'ç¤¾å“¡ID': 'id_002', 'éƒ¨ç½²': 'å–¶æ¥­éƒ¨', 'Q1.åˆ©ç”¨é »åº¦': 'é€±ã«æ•°å›', 'Q2.ãƒã‚¤ãƒ³ãƒ‰': 'ã‚„ã‚„ãƒãƒ£ãƒ³ã‚¹', 'Q3.æŒ‡ç¤ºè‡ªä¿¡': 'å°‘ã—ã‚ã‚‹', 'Q4.è¦‹æŠœãè‡ªä¿¡': 'å¤šåˆ†è¦‹æŠœã‘ã‚‹', 'Q5.æ©Ÿå¯†æƒ…å ±å…¥åŠ›': 'ã„ã„ãˆ', 'Q6.è‘—ä½œæ¨©ç†è§£': 'ã‚ã¾ã‚Šç†è§£ã—ã¦ã„ãªã„', 'Xè»¸ã‚¹ã‚³ã‚¢ (æ„æ¬²)': '4', 'Yè»¸ã‚¹ã‚³ã‚¢ (ã‚¹ã‚­ãƒ«)': '3' },
            { 'ç¤¾å“¡ID': 'id_003', 'éƒ¨ç½²': 'å–¶æ¥­éƒ¨', 'Q1.åˆ©ç”¨é »åº¦': 'æœˆã«æ•°å›', 'Q2.ãƒã‚¤ãƒ³ãƒ‰': 'ã©ã¡ã‚‰ã§ã‚‚ãªã„', 'Q3.æŒ‡ç¤ºè‡ªä¿¡': 'ã‚ã¾ã‚Šãªã„', 'Q4.è¦‹æŠœãè‡ªä¿¡': 'ã‚ã¾ã‚Šè‡ªä¿¡ãŒãªã„', 'Q5.æ©Ÿå¯†æƒ…å ±å…¥åŠ›': 'ã‚ã‹ã‚‰ãªã„', 'Q6.è‘—ä½œæ¨©ç†è§£': 'ã‚ã‹ã‚‰ãªã„', 'Xè»¸ã‚¹ã‚³ã‚¢ (æ„æ¬²)': '2.5', 'Yè»¸ã‚¹ã‚³ã‚¢ (ã‚¹ã‚­ãƒ«)': '1' },
            { 'ç¤¾å“¡ID': 'id_004', 'éƒ¨ç½²': 'å–¶æ¥­éƒ¨', 'Q1.åˆ©ç”¨é »åº¦': 'ã»ã¨ã‚“ã©åˆ©ç”¨ã—ã¦ã„ãªã„', 'Q2.ãƒã‚¤ãƒ³ãƒ‰': 'ã‚„ã‚„è„…å¨', 'Q3.æŒ‡ç¤ºè‡ªä¿¡': 'ãªã„', 'Q4.è¦‹æŠœãè‡ªä¿¡': 'ã‚ã¾ã‚Šè‡ªä¿¡ãŒãªã„', 'Q5.æ©Ÿå¯†æƒ…å ±å…¥åŠ›': 'ã¯ã„', 'Q6.è‘—ä½œæ¨©ç†è§£': 'å…¨ãç†è§£ã—ã¦ã„ãªã„', 'Xè»¸ã‚¹ã‚³ã‚¢ (æ„æ¬²)': '1.5', 'Yè»¸ã‚¹ã‚³ã‚¢ (ã‚¹ã‚­ãƒ«)': '1' },
            { 'ç¤¾å“¡ID': 'id_005', 'éƒ¨ç½²': 'é–‹ç™ºéƒ¨', 'Q1.åˆ©ç”¨é »åº¦': 'æ¯æ—¥åˆ©ç”¨', 'Q2.ãƒã‚¤ãƒ³ãƒ‰': 'å¤§ããªãƒãƒ£ãƒ³ã‚¹', 'Q3.æŒ‡ç¤ºè‡ªä¿¡': 'è‡ªä¿¡ãŒã‚ã‚‹', 'Q4.è¦‹æŠœãè‡ªä¿¡': 'è¦‹æŠœã‘ã‚‹', 'Q5.æ©Ÿå¯†æƒ…å ±å…¥åŠ›': 'ã„ã„ãˆ', 'Q6.è‘—ä½œæ¨©ç†è§£': 'ç†è§£ã—ã¦ã„ã‚‹', 'Xè»¸ã‚¹ã‚³ã‚¢ (æ„æ¬²)': '5', 'Yè»¸ã‚¹ã‚³ã‚¢ (ã‚¹ã‚­ãƒ«)': '5' },
            { 'ç¤¾å“¡ID': 'id_006', 'éƒ¨ç½²': 'é–‹ç™ºéƒ¨', 'Q1.åˆ©ç”¨é »åº¦': 'æ¯æ—¥åˆ©ç”¨', 'Q2.ãƒã‚¤ãƒ³ãƒ‰': 'ã‚„ã‚„ãƒãƒ£ãƒ³ã‚¹', 'Q3.æŒ‡ç¤ºè‡ªä¿¡': 'å°‘ã—ã‚ã‚‹', 'Q4.è¦‹æŠœãè‡ªä¿¡': 'å¤šåˆ†è¦‹æŠœã‘ã‚‹', 'Q5.æ©Ÿå¯†æƒ…å ±å…¥åŠ›': 'ã„ã„ãˆ', 'Q6.è‘—ä½œæ¨©ç†è§£': 'ç†è§£ã—ã¦ã„ã‚‹', 'Xè»¸ã‚¹ã‚³ã‚¢ (æ„æ¬²)': '4.5', 'Yè»¸ã‚¹ã‚³ã‚¢ (ã‚¹ã‚­ãƒ«)': '3' },
            { 'ç¤¾å“¡ID': 'id_007', 'éƒ¨ç½²': 'é–‹ç™ºéƒ¨', 'Q1.åˆ©ç”¨é »åº¦': 'é€±ã«æ•°å›', 'Q2.ãƒã‚¤ãƒ³ãƒ‰': 'ã‚„ã‚„ãƒãƒ£ãƒ³ã‚¹', 'Q3.æŒ‡ç¤ºè‡ªä¿¡': 'å°‘ã—ã‚ã‚‹', 'Q4.è¦‹æŠœãè‡ªä¿¡': 'ã‚ã¾ã‚Šè‡ªä¿¡ãŒãªã„', 'Q5.æ©Ÿå¯†æƒ…å ±å…¥åŠ›': 'ã‚ã‹ã‚‰ãªã„', 'Q6.è‘—ä½œæ¨©ç†è§£': 'ã‚ã‹ã‚‰ãªã„', 'Xè»¸ã‚¹ã‚³ã‚¢ (æ„æ¬²)': '4', 'Yè»¸ã‚¹ã‚³ã‚¢ (ã‚¹ã‚­ãƒ«)': '2' },
            { 'ç¤¾å“¡ID': 'id_008', 'éƒ¨ç½²': 'ãƒãƒ¼ã‚±éƒ¨', 'Q1.åˆ©ç”¨é »åº¦': 'é€±ã«æ•°å›', 'Q2.ãƒã‚¤ãƒ³ãƒ‰': 'å¤§ããªãƒãƒ£ãƒ³ã‚¹', 'Q3.æŒ‡ç¤ºè‡ªä¿¡': 'å°‘ã—ã‚ã‚‹', 'Q4.è¦‹æŠœãè‡ªä¿¡': 'å¤šåˆ†è¦‹æŠœã‘ã‚‹', 'Q5.æ©Ÿå¯†æƒ…å ±å…¥åŠ›': 'ã„ã„ãˆ', 'Q6.è‘—ä½œæ¨©ç†è§£': 'ã‚ã¾ã‚Šç†è§£ã—ã¦ã„ãªã„', 'Xè»¸ã‚¹ã‚³ã‚¢ (æ„æ¬²)': '4.5', 'Yè»¸ã‚¹ã‚³ã‚¢ (ã‚¹ã‚­ãƒ«)': '3' },
            { 'ç¤¾å“¡ID': 'id_009', 'éƒ¨ç½²': 'ãƒãƒ¼ã‚±éƒ¨', 'Q1.åˆ©ç”¨é »åº¦': 'æœˆã«æ•°å›', 'Q2.ãƒã‚¤ãƒ³ãƒ‰': 'ã‚„ã‚„ãƒãƒ£ãƒ³ã‚¹', 'Q3.æŒ‡ç¤ºè‡ªä¿¡': 'ã‚ã¾ã‚Šãªã„', 'Q4.è¦‹æŠœãè‡ªä¿¡': 'ã‚ã¾ã‚Šè‡ªä¿¡ãŒãªã„', 'Q5.æ©Ÿå¯†æƒ…å ±å…¥åŠ›': 'ã¯ã„', 'Q6.è‘—ä½œæ¨©ç†è§£': 'ã‚ã‹ã‚‰ãªã„', 'Xè»¸ã‚¹ã‚³ã‚¢ (æ„æ¬²)': '3', 'Yè»¸ã‚¹ã‚³ã‚¢ (ã‚¹ã‚­ãƒ«)': '1' },
            { 'ç¤¾å“¡ID': 'id_010', 'éƒ¨ç½²': 'ãƒãƒ¼ã‚±éƒ¨', 'Q1.åˆ©ç”¨é »åº¦': 'ã»ã¨ã‚“ã©åˆ©ç”¨ã—ã¦ã„ãªã„', 'Q2.ãƒã‚¤ãƒ³ãƒ‰': 'ã‚„ã‚„è„…å¨', 'Q3.æŒ‡ç¤ºè‡ªä¿¡': 'ãªã„', 'Q4.è¦‹æŠœãè‡ªä¿¡': 'ã‚ã¾ã‚Šè‡ªä¿¡ãŒãªã„', 'Q5.æ©Ÿå¯†æƒ…å ±å…¥åŠ›': 'ã‚ã‹ã‚‰ãªã„', 'Q6.è‘—ä½œæ¨©ç†è§£': 'å…¨ãç†è§£ã—ã¦ã„ãªã„', 'Xè»¸ã‚¹ã‚³ã‚¢ (æ„æ¬²)': '1.5', 'Yè»¸ã‚¹ã‚³ã‚¢ (ã‚¹ã‚­ãƒ«)': '1' },
            { 'ç¤¾å“¡ID': 'id_011', 'éƒ¨ç½²': 'ç®¡ç†éƒ¨', 'Q1.åˆ©ç”¨é »åº¦': 'æœˆã«æ•°å›', 'Q2.ãƒã‚¤ãƒ³ãƒ‰': 'ã©ã¡ã‚‰ã§ã‚‚ãªã„', 'Q3.æŒ‡ç¤ºè‡ªä¿¡': 'ã‚ã¾ã‚Šãªã„', 'Q4.è¦‹æŠœãè‡ªä¿¡': 'ã‚ã¾ã‚Šè‡ªä¿¡ãŒãªã„', 'Q5.æ©Ÿå¯†æƒ…å ±å…¥åŠ›': 'ã‚ã‹ã‚‰ãªã„', 'Q6.è‘—ä½œæ¨©ç†è§£': 'ã‚ã‹ã‚‰ãªã„', 'Xè»¸ã‚¹ã‚³ã‚¢ (æ„æ¬²)': '2.5', 'Yè»¸ã‚¹ã‚³ã‚¢ (ã‚¹ã‚­ãƒ«)': '1' },
            { 'ç¤¾å“¡ID': 'id_012', 'éƒ¨ç½²': 'ç®¡ç†éƒ¨', 'Q1.åˆ©ç”¨é »åº¦': 'ã»ã¨ã‚“ã©åˆ©ç”¨ã—ã¦ã„ãªã„', 'Q2.ãƒã‚¤ãƒ³ãƒ‰': 'è„…å¨', 'Q3.æŒ‡ç¤ºè‡ªä¿¡': 'ãªã„', 'Q4.è¦‹æŠœãè‡ªä¿¡': 'ã‚ã¾ã‚Šè‡ªä¿¡ãŒãªã„', 'Q5.æ©Ÿå¯†æƒ…å ±å…¥åŠ›': 'ã¯ã„', 'Q6.è‘—ä½œæ¨©ç†è§£': 'å…¨ãç†è§£ã—ã¦ã„ãªã„', 'Xè»¸ã‚¹ã‚³ã‚¢ (æ„æ¬²)': '1', 'Yè»¸ã‚¹ã‚³ã‚¢ (ã‚¹ã‚­ãƒ«)': '1' },
            { 'ç¤¾å“¡ID': 'id_013', 'éƒ¨ç½²': 'ç®¡ç†éƒ¨', 'Q1.åˆ©ç”¨é »åº¦': 'ã»ã¨ã‚“ã©åˆ©ç”¨ã—ã¦ã„ãªã„', 'Q2.ãƒã‚¤ãƒ³ãƒ‰': 'ã©ã¡ã‚‰ã§ã‚‚ãªã„', 'Q3.æŒ‡ç¤ºè‡ªä¿¡': 'ã‚ã¾ã‚Šãªã„', 'Q4.è¦‹æŠœãè‡ªä¿¡': 'ã‚ã¾ã‚Šè‡ªä¿¡ãŒãªã„', 'Q5.æ©Ÿå¯†æƒ…å ±å…¥åŠ›': 'ã‚ã‹ã‚‰ãªã„', 'Q6.è‘—ä½œæ¨©ç†è§£': 'ã‚ã‹ã‚‰ãªã„', 'Xè»¸ã‚¹ã‚³ã‚¢ (æ„æ¬²)': '2', 'Yè»¸ã‚¹ã‚³ã‚¢ (ã‚¹ã‚­ãƒ«)': '1' },
            { 'ç¤¾å“¡ID': 'id_014', 'éƒ¨ç½²': 'å–¶æ¥­éƒ¨', 'Q1.åˆ©ç”¨é »åº¦': 'æ¯æ—¥åˆ©ç”¨', 'Q2.ãƒã‚¤ãƒ³ãƒ‰': 'å¤§ããªãƒãƒ£ãƒ³ã‚¹', 'Q3.æŒ‡ç¤ºè‡ªä¿¡': 'å°‘ã—ã‚ã‚‹', 'Q4.è¦‹æŠœãè‡ªä¿¡': 'å¤šåˆ†è¦‹æŠœã‘ã‚‹', 'Q5.æ©Ÿå¯†æƒ…å ±å…¥åŠ›': 'ã„ã„ãˆ', 'Q6.è‘—ä½œæ¨©ç†è§£': 'ã‚ã¾ã‚Šç†è§£ã—ã¦ã„ãªã„', 'Xè»¸ã‚¹ã‚³ã‚¢ (æ„æ¬²)': '5', 'Yè»¸ã‚¹ã‚³ã‚¢ (ã‚¹ã‚­ãƒ«)': '3' },
            { 'ç¤¾å“¡ID': 'id_015', 'éƒ¨ç½²': 'é–‹ç™ºéƒ¨', 'Q1.åˆ©ç”¨é »åº¦': 'é€±ã«æ•°å›', 'Q2.ãƒã‚¤ãƒ³ãƒ‰': 'ã‚„ã‚„ãƒãƒ£ãƒ³ã‚¹', 'Q3.æŒ‡ç¤ºè‡ªä¿¡': 'è‡ªä¿¡ãŒã‚ã‚‹', 'Q4.è¦‹æŠœãè‡ªä¿¡': 'è¦‹æŠœã‘ã‚‹', 'Q5.æ©Ÿå¯†æƒ…å ±å…¥åŠ›': 'ã„ã„ãˆ', 'Q6.è‘—ä½œæ¨©ç†è§£': 'ç†è§£ã—ã¦ã„ã‚‹', 'Xè»¸ã‚¹ã‚³ã‚¢ (æ„æ¬²)': '4', 'Yè»¸ã‚¹ã‚³ã‚¢ (ã‚¹ã‚­ãƒ«)': '5' }
        ];

        // ãƒ‡ãƒ¼ã‚¿åˆ†æ
        const analyzeData = (data) => {
            if (!data || data.length === 0) return null;

            const quadrants = { leader: [], challenger: [], cautious: [], inactive: [] };

            data.forEach(row => {
                const xScore = parseFloat(row['Xè»¸ã‚¹ã‚³ã‚¢ (æ„æ¬²)']) || 0;
                const yScore = parseFloat(row['Yè»¸ã‚¹ã‚³ã‚¢ (ã‚¹ã‚­ãƒ«)']) || 0;
                
                if (xScore >= 3.5 && yScore >= 3.5) quadrants.leader.push(row);
                else if (xScore >= 3.5 && yScore < 3.5) quadrants.challenger.push(row);
                else if (xScore < 3.5 && yScore >= 3.5) quadrants.cautious.push(row);
                else quadrants.inactive.push(row);
            });

            const riskAnalysis = {
                confidentialInput: data.filter(r => r['Q5.æ©Ÿå¯†æƒ…å ±å…¥åŠ›'] === 'ã¯ã„').length,
                copyrightLow: data.filter(r => 
                    r['Q6.è‘—ä½œæ¨©ç†è§£'] === 'å…¨ãç†è§£ã—ã¦ã„ãªã„' || 
                    r['Q6.è‘—ä½œæ¨©ç†è§£'] === 'ã‚ã¾ã‚Šç†è§£ã—ã¦ã„ãªã„' ||
                    r['Q6.è‘—ä½œæ¨©ç†è§£'] === 'ã‚ã‹ã‚‰ãªã„'
                ).length,
                total: data.length
            };

            const departments = {};
            data.forEach(row => {
                const dept = row['éƒ¨ç½²'];
                if (!departments[dept]) {
                    departments[dept] = { name: dept, count: 0, avgSkill: 0, avgMotivation: 0, highRisk: 0 };
                }
                departments[dept].count++;
                departments[dept].avgSkill += parseFloat(row['Yè»¸ã‚¹ã‚³ã‚¢ (ã‚¹ã‚­ãƒ«)']) || 0;
                departments[dept].avgMotivation += parseFloat(row['Xè»¸ã‚¹ã‚³ã‚¢ (æ„æ¬²)']) || 0;
                if (row['Q5.æ©Ÿå¯†æƒ…å ±å…¥åŠ›'] === 'ã¯ã„') departments[dept].highRisk++;
            });

            Object.keys(departments).forEach(dept => {
                departments[dept].avgSkill = (departments[dept].avgSkill / departments[dept].count).toFixed(1);
                departments[dept].avgMotivation = (departments[dept].avgMotivation / departments[dept].count).toFixed(1);
            });

            return { quadrants, riskAnalysis, departments: Object.values(departments), totalEmployees: data.length };
        };

        // ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒª
        function App() {
            const [analysis, setAnalysis] = useState(null);
            const [data, setData] = useState(null);
            const [showResults, setShowResults] = useState(false);
            const [loading, setLoading] = useState(false);

            const handleStartDiagnosis = () => {
                setLoading(true);
                
                // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã§åˆ†æã‚’å®Ÿè¡Œ
                setTimeout(() => {
                    setData(SAMPLE_DATA);
                    const analysisResult = analyzeData(SAMPLE_DATA);
                    setAnalysis(analysisResult);
                    setShowResults(true);
                    setLoading(false);
                }, 1000); // 1ç§’ã®ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ¼”å‡º
            };

            if (!showResults) {
                return <LandingPage onStart={handleStartDiagnosis} loading={loading} />;
            }

            return <DiagnosisResults analysis={analysis} data={data} />;
        }

        // ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸
        function LandingPage({ onStart, loading }) {
            return (
                <div className="min-h-screen bg-gradient-to-b from-white to-gray-100">
                    <header className="bg-white shadow-sm">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
                            <div className="flex items-center justify-between">
                                <h1 className="text-2xl font-bold accent-color">AIæ´»ç”¨è¨ºæ–­ãƒ¬ãƒãƒ¼ãƒˆ</h1>
                                <div className="text-sm text-gray-600">powered by AIQæ ªå¼ä¼šç¤¾</div>
                            </div>
                        </div>
                    </header>

                    <main className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
                        <div className="text-center mb-12">
                            <h2 className="text-4xl font-bold text-gray-900 mb-4">
                                å¾¡ç¤¾ã®AIæ´»ç”¨ãƒ¬ãƒ™ãƒ«ã‚’<br />
                                <span className="accent-color">ãŸã£ãŸ1åˆ†ã§å¯è¦–åŒ–</span>
                            </h2>
                            <p className="text-xl text-gray-600">
                                ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆçµæœã‹ã‚‰è‡ªå‹•ã§è¨ºæ–­ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã—ã¾ã™
                            </p>
                        </div>

                        <div className="bg-white rounded-lg shadow-lg p-8 mb-12">
                            <div className="text-center mb-6">
                                <p className="text-lg text-gray-700 mb-4">
                                    ã“ã®ãƒ‡ãƒ¢ã§ã¯ã€ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¦è¨ºæ–­çµæœã‚’è¡¨ç¤ºã—ã¾ã™
                                </p>
                                <div className="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                                    <p className="text-sm text-blue-800">
                                        <strong>ğŸ’¡ æœ¬ç•ªåˆ©ç”¨æ™‚:</strong> Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã¨é€£æºã—ã¦ã€<br />
                                        å®Ÿéš›ã®ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã§è¨ºæ–­ã§ãã¾ã™
                                    </p>
                                </div>
                            </div>
                            
                            <button
                                onClick={onStart}
                                disabled={loading}
                                className="w-full accent-bg text-white font-bold py-4 px-6 rounded-lg hover:bg-green-600 transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed text-lg"
                            >
                                {loading ? (
                                    <span className="flex items-center justify-center">
                                        <div className="loading-spinner mr-3" style={{width: '20px', height: '20px', borderWidth: '3px'}}></div>
                                        åˆ†æä¸­...
                                    </span>
                                ) : (
                                    'è¨ºæ–­ã‚’é–‹å§‹ã™ã‚‹ ğŸ”'
                                )}
                            </button>
                        </div>

                        <div className="grid md:grid-cols-3 gap-6">
                            <div className="bg-white p-6 rounded-lg shadow">
                                <div className="text-3xl mb-3">âœ“</div>
                                <h3 className="font-bold text-lg mb-2">100ç¤¾ä»¥ä¸ŠãŒæ´»ç”¨</h3>
                                <p className="text-gray-600 text-sm">ä¼æ¥­ã®AIæ´»ç”¨æ¨é€²ã‚’æ”¯æ´</p>
                            </div>
                            <div className="bg-white p-6 rounded-lg shadow">
                                <div className="text-3xl mb-3">ğŸ’°</div>
                                <h3 className="font-bold text-lg mb-2">åŠ©æˆé‡‘å¯¾å¿œç ”ä¿®</h3>
                                <p className="text-gray-600 text-sm">è²»ç”¨ã®75%ãŒè£œåŠ©ã•ã‚Œã¾ã™</p>
                            </div>
                            <div className="bg-white p-6 rounded-lg shadow">
                                <div className="text-3xl mb-3">ğŸ“Š</div>
                                <h3 className="font-bold text-lg mb-2">å³åº§ã«å¯è¦–åŒ–</h3>
                                <p className="text-gray-600 text-sm">ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§åˆ†æãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ</p>
                            </div>
                        </div>
                    </main>
                </div>
            );
        }

        // è¨ºæ–­çµæœãƒšãƒ¼ã‚¸
        function DiagnosisResults({ analysis, data }) {
            const scatterChartRef = useRef(null);
            const barChartRef = useRef(null);
            const scatterChart = useRef(null);
            const barChart = useRef(null);

            const quadrantPercentages = {
                leader: ((analysis.quadrants.leader.length / analysis.totalEmployees) * 100).toFixed(0),
                challenger: ((analysis.quadrants.challenger.length / analysis.totalEmployees) * 100).toFixed(0),
                cautious: ((analysis.quadrants.cautious.length / analysis.totalEmployees) * 100).toFixed(0),
                inactive: ((analysis.quadrants.inactive.length / analysis.totalEmployees) * 100).toFixed(0)
            };

            const riskPercentages = {
                confidential: ((analysis.riskAnalysis.confidentialInput / analysis.riskAnalysis.total) * 100).toFixed(0),
                copyright: ((analysis.riskAnalysis.copyrightLow / analysis.riskAnalysis.total) * 100).toFixed(0)
            };

            const leaderRate = parseFloat(quadrantPercentages.leader);
            const riskRate = Math.max(parseFloat(riskPercentages.confidential), parseFloat(riskPercentages.copyright));
            
            let aiLevel = 'é–¢å¿ƒå…ˆè¡Œå‹';
            let aiLevelStars = 3;
            let aiLevelDescription = 'AIæ´»ç”¨ã¸ã®é–¢å¿ƒã¯é«˜ã„ã‚‚ã®ã®ã€ã‚¹ã‚­ãƒ«ã¨ãƒªã‚¹ã‚¯ç®¡ç†ãŒè¿½ã„ã¤ã„ã¦ã„ãªã„çŠ¶æ…‹ã§ã™';

            if (leaderRate >= 30 && riskRate < 20) {
                aiLevel = 'æˆç†ŸæœŸ';
                aiLevelStars = 5;
                aiLevelDescription = 'å…¨ç¤¾çš„ã«AIæ´»ç”¨ãŒé€²ã¿ã€ãƒªã‚¹ã‚¯ç®¡ç†ã‚‚é©åˆ‡ã«è¡Œã‚ã‚Œã¦ã„ã¾ã™';
            } else if (leaderRate >= 20 && riskRate < 30) {
                aiLevel = 'æˆé•·æœŸ';
                aiLevelStars = 4;
                aiLevelDescription = 'AIæ´»ç”¨ãŒåºƒãŒã‚Šã¤ã¤ã‚ã‚Šã€æ›´ãªã‚‹æ¨é€²ãŒæœŸå¾…ã§ãã‚‹æ®µéšã§ã™';
            } else if (leaderRate < 10 && riskRate > 40) {
                aiLevel = 'è¦æ³¨æ„æœŸ';
                aiLevelStars = 2;
                aiLevelDescription = 'ãƒªã‚¹ã‚¯ç®¡ç†ã®ä½“åˆ¶æ•´å‚™ãŒæ€¥å‹™ã§ã™';
            }

            const COLORS = { 'å–¶æ¥­éƒ¨': '#5cb85c', 'é–‹ç™ºéƒ¨': '#5bc0de', 'ãƒãƒ¼ã‚±éƒ¨': '#f0ad4e', 'ç®¡ç†éƒ¨': '#d9534f' };

            // æ•£å¸ƒå›³ãƒ‡ãƒ¼ã‚¿
            useEffect(() => {
                if (scatterChartRef.current) {
                    const ctx = scatterChartRef.current.getContext('2d');
                    
                    if (scatterChart.current) {
                        scatterChart.current.destroy();
                    }

                    const scatterData = data.map(row => ({
                        x: parseFloat(row['Xè»¸ã‚¹ã‚³ã‚¢ (æ„æ¬²)']) || 0,
                        y: parseFloat(row['Yè»¸ã‚¹ã‚³ã‚¢ (ã‚¹ã‚­ãƒ«)']) || 0,
                        dept: row['éƒ¨ç½²']
                    }));

                    const datasets = Object.keys(COLORS).map(dept => ({
                        label: dept,
                        data: scatterData.filter(d => d.dept === dept),
                        backgroundColor: COLORS[dept],
                        pointRadius: 8
                    }));

                    scatterChart.current = new Chart(ctx, {
                        type: 'scatter',
                        data: { datasets },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                x: { title: { display: true, text: 'æ„æ¬² â†’' }, min: 0, max: 5.5 },
                                y: { title: { display: true, text: 'â† ã‚¹ã‚­ãƒ«' }, min: 0, max: 5.5 }
                            },
                            plugins: {
                                legend: { display: true, position: 'bottom' }
                            }
                        }
                    });
                }

                return () => {
                    if (scatterChart.current) {
                        scatterChart.current.destroy();
                    }
                };
            }, [data]);

            // æ£’ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿
            useEffect(() => {
                if (barChartRef.current) {
                    const ctx = barChartRef.current.getContext('2d');
                    
                    if (barChart.current) {
                        barChart.current.destroy();
                    }

                    const deptData = analysis.departments;

                    barChart.current = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: deptData.map(d => d.name),
                            datasets: [
                                {
                                    label: 'ã‚¹ã‚­ãƒ«',
                                    data: deptData.map(d => parseFloat(d.avgSkill)),
                                    backgroundColor: '#5cb85c'
                                },
                                {
                                    label: 'æ„æ¬²',
                                    data: deptData.map(d => parseFloat(d.avgMotivation)),
                                    backgroundColor: '#5bc0de'
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: { y: { min: 0, max: 5 } },
                            plugins: { legend: { display: true, position: 'bottom' } }
                        }
                    });
                }

                return () => {
                    if (barChart.current) {
                        barChart.current.destroy();
                    }
                };
            }, [analysis]);

            return (
                <div className="min-h-screen bg-gray-50">
                    <header className="bg-white shadow-sm sticky top-0 z-50">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
                            <div className="flex items-center justify-between">
                                <h1 className="text-xl font-bold accent-color">AIæ´»ç”¨è¨ºæ–­ãƒ¬ãƒãƒ¼ãƒˆ</h1>
                                <div className="flex items-center gap-4">
                                    <div className="text-sm text-gray-600">â€» ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã§è¡¨ç¤ºä¸­</div>
                                    <button 
                                        onClick={() => window.location.reload()} 
                                        className="text-sm px-4 py-2 bg-gray-100 rounded hover:bg-gray-200 transition"
                                    >
                                        â† æ–°ã—ã„è¨ºæ–­
                                    </button>
                                </div>
                            </div>
                        </div>
                    </header>

                    <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                        {/* ã‚µãƒãƒªãƒ¼ */}
                        <div className="bg-white rounded-lg shadow-lg p-8 mb-8">
                            <h2 className="text-2xl font-bold mb-4">ğŸ¯ è¨ºæ–­çµæœã‚µãƒãƒªãƒ¼</h2>
                            <div className="flex items-center gap-4 mb-4">
                                <div>
                                    <div className="text-sm text-gray-600">å¾¡ç¤¾ã®AIæ´»ç”¨ãƒ¬ãƒ™ãƒ«</div>
                                    <div className="text-3xl font-bold accent-color">
                                        {'â˜…'.repeat(aiLevelStars)}{'â˜†'.repeat(5-aiLevelStars)} {aiLevel}
                                    </div>
                                </div>
                            </div>
                            <p className="text-gray-700 mb-6">{aiLevelDescription}</p>
                            
                            {(parseFloat(riskPercentages.confidential) > 30 || parseFloat(riskPercentages.copyright) > 40) && (
                                <div className="bg-red-50 border-l-4 border-red-500 p-4">
                                    <div className="flex items-start">
                                        <div className="text-2xl mr-3">âš ï¸</div>
                                        <div>
                                            <h3 className="font-bold text-red-800 mb-1">ç·Šæ€¥èª²é¡Œ</h3>
                                            <p className="text-red-700">
                                                ãƒªã‚¹ã‚¯èªçŸ¥åº¦ãŒä½ãã€æƒ…å ±æ¼æ´©ã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™
                                                ï¼ˆæ©Ÿå¯†æƒ…å ±å…¥åŠ›: {riskPercentages.confidential}%ã€è‘—ä½œæ¨©ç†è§£ä¸è¶³: {riskPercentages.copyright}%ï¼‰
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>

                        {/* 4è±¡é™ãƒãƒˆãƒªã‚¯ã‚¹ */}
                        <div className="bg-white rounded-lg shadow-lg p-8 mb-8">
                            <h2 className="text-2xl font-bold mb-4">ğŸ“Š 4è±¡é™ãƒãƒˆãƒªã‚¯ã‚¹ï¼ˆç¤¾å“¡åˆ†é¡ï¼‰</h2>
                            <div className="grid md:grid-cols-2 gap-8">
                                <div style={{height: '400px'}}>
                                    <canvas ref={scatterChartRef}></canvas>
                                </div>
                                <div className="space-y-4">
                                    <QuadrantCard 
                                        emoji="ğŸŒŸ" title="AIãƒªãƒ¼ãƒ€ãƒ¼" 
                                        percentage={quadrantPercentages.leader}
                                        count={analysis.quadrants.leader.length}
                                        description="é«˜ã‚¹ã‚­ãƒ« Ã— é«˜æ„æ¬²ã€‚ç¤¾å†…ã®AIæ¨é€²å½¹ã¨ã—ã¦æ´»èº"
                                        color="bg-green-50 border-green-200"
                                    />
                                    <QuadrantCard 
                                        emoji="ğŸš€" title="AIæŒ‘æˆ¦è€…" 
                                        percentage={quadrantPercentages.challenger}
                                        count={analysis.quadrants.challenger.length}
                                        description="ä½ã‚¹ã‚­ãƒ« Ã— é«˜æ„æ¬²ã€‚æ•™è‚²ã™ã¹ãå„ªå…ˆå±¤"
                                        color="bg-blue-50 border-blue-200"
                                    />
                                    <QuadrantCard 
                                        emoji="ğŸ˜´" title="AIæ…é‡æ´¾" 
                                        percentage={quadrantPercentages.cautious}
                                        count={analysis.quadrants.cautious.length}
                                        description="é«˜ã‚¹ã‚­ãƒ« Ã— ä½æ„æ¬²ã€‚æ´»ç”¨ä¿ƒé€²ãŒå¿…è¦"
                                        color="bg-yellow-50 border-yellow-200"
                                    />
                                    <QuadrantCard 
                                        emoji="âš ï¸" title="AIæœªç€æ‰‹" 
                                        percentage={quadrantPercentages.inactive}
                                        count={analysis.quadrants.inactive.length}
                                        description="ä½ã‚¹ã‚­ãƒ« Ã— ä½æ„æ¬²ã€‚æœ€å„ªå…ˆã§æ•™è‚²ã™ã¹ãå±¤"
                                        color="bg-red-50 border-red-200"
                                    />
                                </div>
                            </div>
                        </div>

                        {/* ãƒªã‚¹ã‚¯åˆ†æ */}
                        <div className="bg-white rounded-lg shadow-lg p-8 mb-8">
                            <h2 className="text-2xl font-bold mb-4">âš ï¸ ãƒªã‚¹ã‚¯åˆ†æ</h2>
                            <div className="grid md:grid-cols-2 gap-6">
                                <RiskCard
                                    title="æ©Ÿå¯†æƒ…å ±ã‚’å…¥åŠ›"
                                    percentage={riskPercentages.confidential}
                                    count={analysis.riskAnalysis.confidentialInput}
                                    total={analysis.riskAnalysis.total}
                                    level={parseFloat(riskPercentages.confidential)}
                                />
                                <RiskCard
                                    title="è‘—ä½œæ¨©ç†è§£åº¦ãŒä½ã„"
                                    percentage={riskPercentages.copyright}
                                    count={analysis.riskAnalysis.copyrightLow}
                                    total={analysis.riskAnalysis.total}
                                    level={parseFloat(riskPercentages.copyright)}
                                />
                            </div>
                        </div>

                        {/* éƒ¨ç½²åˆ¥æ¯”è¼ƒ */}
                        <div className="bg-white rounded-lg shadow-lg p-8 mb-8">
                            <h2 className="text-2xl font-bold mb-4">ğŸ“ˆ éƒ¨ç½²åˆ¥æ¯”è¼ƒ</h2>
                            <div style={{height: '300px'}}>
                                <canvas ref={barChartRef}></canvas>
                            </div>
                        </div>

                        {/* ææ¡ˆ */}
                        <div className="bg-gradient-to-r from-green-50 to-blue-50 rounded-lg shadow-lg p-8 mb-8">
                            <h2 className="text-2xl font-bold mb-4">ğŸ’¡ å¾¡ç¤¾ã¸ã®ææ¡ˆ</h2>
                            <div className="space-y-4 mb-6">
                                {parseFloat(quadrantPercentages.challenger) + parseFloat(quadrantPercentages.inactive) > 50 && (
                                    <div className="flex items-start">
                                        <div className="text-2xl mr-3">1ï¸âƒ£</div>
                                        <div>
                                            <h3 className="font-bold mb-1">AIæ½œåœ¨å±¤ï¼ˆ{(parseFloat(quadrantPercentages.challenger) + parseFloat(quadrantPercentages.inactive)).toFixed(0)}%ï¼‰ã¸ã®åŸºç¤ç ”ä¿®</h3>
                                            <p className="text-gray-700">ã‚¹ã‚­ãƒ«ä¸è¶³ã®ç¤¾å“¡ãŒéåŠæ•°ã€‚åŸºç¤ã‹ã‚‰å­¦ã¹ã‚‹ç ”ä¿®ãŒå¿…è¦ã§ã™</p>
                                        </div>
                                    </div>
                                )}
                                {(parseFloat(riskPercentages.confidential) > 20 || parseFloat(riskPercentages.copyright) > 30) && (
                                    <div className="flex items-start">
                                        <div className="text-2xl mr-3">2ï¸âƒ£</div>
                                        <div>
                                            <h3 className="font-bold mb-1">ãƒªã‚¹ã‚¯ç®¡ç†ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã®ç­–å®š</h3>
                                            <p className="text-gray-700">æƒ…å ±æ¼æ´©ãƒªã‚¹ã‚¯ãŒé«˜ã„çŠ¶æ…‹ã€‚ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³æ•´å‚™ãŒæ€¥å‹™ã§ã™</p>
                                        </div>
                                    </div>
                                )}
                                <div className="flex items-start">
                                    <div className="text-2xl mr-3">3ï¸âƒ£</div>
                                    <div>
                                        <h3 className="font-bold mb-1">éƒ¨é–€åˆ¥AIæ´»ç”¨ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—</h3>
                                        <p className="text-gray-700">éƒ¨ç½²ã”ã¨ã«æ´»ç”¨çŠ¶æ³ãŒç•°ãªã‚Šã¾ã™ã€‚æ¥­å‹™ã«å³ã—ãŸå®Ÿè·µç ”ä¿®ãŒåŠ¹æœçš„ã§ã™</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div className="bg-white rounded-lg p-6 border-2 accent-border">
                                <p className="text-center text-lg font-bold mb-4">
                                    ğŸ‘‰ ã“ã‚Œã‚‰ã®èª²é¡Œã‚’è§£æ±ºã™ã‚‹ç ”ä¿®ãŒ<br />
                                    <span className="accent-color text-2xl">åŠ©æˆé‡‘ï¼ˆè²»ç”¨ã®75%è£œåŠ©ï¼‰</span>ã§å—ã‘ã‚‰ã‚Œã¾ã™!
                                </p>
                                <div className="text-center space-y-4">
                                    <a
                                        href="https://docs.google.com/presentation/d/1dLYP6QHsOEpkyO7uv_wofMpjfnSpmVLA/edit?usp=sharing&ouid=103204391834075285914&rtpof=true&sd=true"
                                        target="_blank"
                                        rel="noopener noreferrer"
                                        className="inline-block bg-blue-500 text-white font-bold py-4 px-8 rounded-lg hover:bg-blue-600 transition duration-200 text-lg"
                                    >
                                        ğŸ“Š AIç ”ä¿®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®è©³ç´°ã‚’è¦‹ã‚‹
                                    </a>
                                    <br />
                                    <a
                                        href="https://calendly.com"
                                        target="_blank"
                                        rel="noopener noreferrer"
                                        className="inline-block accent-bg text-white font-bold py-4 px-8 rounded-lg hover:bg-green-600 transition duration-200 text-lg"
                                    >
                                        30åˆ†ç„¡æ–™ç›¸è«‡ã‚’äºˆç´„ã™ã‚‹ ğŸ¯
                                    </a>
                                </div>
                            </div>
                        </div>

                        <div className="text-center text-gray-600 text-sm">
                            <p>Â© 2024 AIæ´»ç”¨è¨ºæ–­ãƒ¬ãƒãƒ¼ãƒˆ. All rights reserved.</p>
                        </div>
                    </main>
                </div>
            );
        }

        function QuadrantCard({ emoji, title, percentage, count, description, color }) {
            return (
                <div className={`${color} border rounded-lg p-4`}>
                    <div className="flex items-center justify-between mb-2">
                        <div className="flex items-center gap-2">
                            <span className="text-2xl">{emoji}</span>
                            <span className="font-bold text-lg">{title}</span>
                        </div>
                        <span className="text-2xl font-bold">{percentage}%</span>
                    </div>
                    <p className="text-sm text-gray-600 mb-1">{description}</p>
                    <p className="text-xs text-gray-500">{count}å</p>
                </div>
            );
        }

        function RiskCard({ title, percentage, count, total, level }) {
            const getColor = (level) => {
                if (level >= 40) return { bg: 'bg-red-100', text: 'text-red-700', icon: 'ğŸ”´' };
                if (level >= 20) return { bg: 'bg-yellow-100', text: 'text-yellow-700', icon: 'ğŸŸ¡' };
                return { bg: 'bg-green-100', text: 'text-green-700', icon: 'ğŸŸ¢' };
            };

            const color = getColor(level);

            return (
                <div className={`${color.bg} rounded-lg p-6`}>
                    <div className="flex items-center justify-between mb-2">
                        <h3 className="font-bold text-lg">{title}</h3>
                        <span className="text-2xl">{color.icon}</span>
                    </div>
                    <div className={`text-4xl font-bold ${color.text} mb-2`}>{percentage}%</div>
                    <p className="text-sm text-gray-600">{count}å / {total}å</p>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>